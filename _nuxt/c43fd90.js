(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{441:function(e,t,n){"use strict";n.r(t);n(25),n(57),n(30),n(59),n(40),n(14),n(49),n(38),n(8),n(44),n(58),n(41);function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){d=!0,l=e},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw l}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var l={data:function(){return{headers:[{text:"Имя",value:"name"},{text:"Решено",value:"solved"},{text:"Потрачено",value:"spent"},{text:"🤑",value:"cash"}],players:[],error:{visibility:!1,text:""},editNameDialog:{visible:!1,userId:void 0,name:""}}},methods:{openEditNameDialog:function(e){this.editNameDialog.visible=!0,this.editNameDialog.userId=e;var t,n=r(this.players);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.id==e){this.editNameDialog.name=o.name;break}}}catch(e){n.e(e)}finally{n.f()}},changeName:function(){this.editNameDialog.visible=!1,this.$ws.send(JSON.stringify({type:"request",params:{type:"setName",name:this.editNameDialog.name,id:this.editNameDialog.userId}}))},wsDataReceived:function(data){"response"==(data=JSON.parse(data)).type?this.responseReceived(data):this.requestReceived(data)},responseReceived:function(data){var e=this;console.log("response",data),"setNameError"==data.params.event&&this.showError("Похоже вы не подключены к игре"),"joinError"==data.params.event&&(this.showError("Ваш ключ недействителен. Сейчас вы будете переведены на страницу входа"),setTimeout((function(){e.$nuxt.$router.replace({path:"/"})}),3e3)),"getPlayersSuccess"==data.params.event&&(this.players=data.params.players)},requestReceived:function(data){console.log("request",data),"playersListUpdated"==data.params.event&&(this.players=data.params.players),"setNewName"==data.params.event&&this.$store.commit("setName",data.params.name)},showError:function(text){var e=this;this.error.visibility=!0,this.error.text=text,setTimeout((function(){e.error.visibility=!1}),3e3)},setName:function(){this.$ws.send(JSON.stringify({type:"request",params:{type:"setName",name:this.$store.state.name}}))},joinGame:function(){this.$ws.send(JSON.stringify({type:"request",params:{type:"joinGame",key:this.$store.state.key}}))},getPlayers:function(){this.$ws.send(JSON.stringify({type:"request",params:{type:"getPlayers"}}))},incSolved:function(e){this.$ws.send(JSON.stringify({type:"request",params:{type:"incSolved",playerId:e}}))},decSolved:function(e){this.$ws.send(JSON.stringify({type:"request",params:{type:"decSolved",playerId:e}}))},incSpent:function(e){this.$ws.send(JSON.stringify({type:"request",params:{type:"incSpent",playerId:e}}))},decSpent:function(e){this.$ws.send(JSON.stringify({type:"request",params:{type:"decSpent",playerId:e}}))},tryToConnect:function(){1==this.$ws.readyState?(this.joinGame(),this.setName(),this.getPlayers()):setTimeout(this.tryToConnect,500)}},mounted:function(){var e=this;this.$ws.onmessage=function(t){e.wsDataReceived(t.data)},this.tryToConnect()}},c=n(75),d=n(98),v=n.n(d),m=n(447),f=n(320),y=n(344),h=n(333),_=n(440),N=n(444),S=n(319),w=n(330),k=n(435),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt-10"},[n("v-alert",{attrs:{type:"error",value:e.error.visibility,transition:"scale-transition"}},[e._v("\n    "+e._s(e.error.text)+"\n  ")]),e._v(" "),n("h2",[e._v("😎 "+e._s(e.$store.state.name))]),e._v(" "),n("v-card",{staticClass:"mt-6 pa-6",attrs:{elevation:"2"}},[n("v-card-title",[e._v(" 🏆 Турнирная таблица ")]),e._v(" "),n("v-card-text",[n("v-data-table",{attrs:{headers:e.headers,items:e.players,"items-per-page":10,"sort-by":"cash","sort-desc":!0},scopedSlots:e._u([{key:"item.name",fn:function(t){var r=t.item;return[n("span",{class:{"font-weight-black":"admin"==r.role,"green--text text--accent-3":"admin"==r.role}},[e._v(e._s(r.name)+" "+e._s("admin"==r.role?"🎓":""))]),e._v(" "),"admin"==e.$store.state.role?n("v-btn",{attrs:{fab:"",plain:"","x-small":"",color:"blue-grey darken-2"},on:{click:function(t){return e.openEditNameDialog(r.id)}}},[n("v-icon",[e._v("mdi-pencil-outline")])],1):e._e()]}},{key:"item.solved",fn:function(t){var r=t.item;return["admin"==e.$store.state.role?n("v-btn",{attrs:{fab:"",plain:"",color:"blue-grey darken-2"},on:{click:function(t){return e.decSolved(r.id)}}},[e._v("-")]):e._e(),e._v(" "),n("span",{staticClass:"green--text text--darken-2"},[e._v(e._s(r.solved))]),e._v(" "),"admin"==e.$store.state.role?n("v-btn",{attrs:{fab:"",plain:"",color:"blue-grey darken-2"},on:{click:function(t){return e.incSolved(r.id)}}},[e._v("+")]):e._e()]}},{key:"item.spent",fn:function(t){var r=t.item;return["admin"==e.$store.state.role?n("v-btn",{attrs:{fab:"",plain:"",color:"blue-grey darken-2"},on:{click:function(t){return e.decSpent(r.id)}}},[e._v("-")]):e._e(),e._v(" "),n("span",{staticClass:"red--text text--darken-2"},[e._v(e._s(r.spent))]),e._v(" "),"admin"==e.$store.state.role?n("v-btn",{attrs:{fab:"",plain:"",color:"blue-grey darken-2"},on:{click:function(t){return e.incSpent(r.id)}}},[e._v("+")]):e._e()]}}])})],1)],1),e._v(" "),n("v-dialog",{attrs:{persistent:"","max-width":"300"},model:{value:e.editNameDialog.visible,callback:function(t){e.$set(e.editNameDialog,"visible",t)},expression:"editNameDialog.visible"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("\n        Сменить имя\n      ")]),e._v(" "),n("v-card-text",[n("v-text-field",{attrs:{label:"Введите новое имя","prepend-inner-icon":"mdi-account-outline"},model:{value:e.editNameDialog.name,callback:function(t){e.$set(e.editNameDialog,"name",t)},expression:"editNameDialog.name"}})],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.editNameDialog.visible=!1}}},[e._v("\n          Отмена\n        ")]),e._v(" "),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){return e.changeName()}}},[e._v("\n          Сменить\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;v()(component,{VAlert:m.a,VBtn:f.a,VCard:y.a,VCardActions:h.a,VCardText:h.c,VCardTitle:h.d,VDataTable:_.a,VDialog:N.a,VIcon:S.a,VSpacer:w.a,VTextField:k.a})}}]);